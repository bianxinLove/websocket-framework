# ThreadPoolMonitorWebSocketService ä¿®å¤è¯´æ˜

## ğŸ”§ ä¿®å¤çš„é—®é¢˜

æˆ‘å·²ç»ä¿®å¤äº† `ThreadPoolMonitorWebSocketService` ä¸­çš„æ‰€æœ‰é—®é¢˜ï¼š

### 1. **æ¥å£å®ç°é—®é¢˜** âœ…
**åŸé—®é¢˜**: æ¥å£æ–¹æ³•ç­¾åä¸åŒ¹é…
```java
// âŒ é”™è¯¯çš„å®ç°
public void handleEvent(WebSocketEvent<String> event)

// âœ… æ­£ç¡®çš„å®ç°  
public Object handleEvent(WebSocketEvent<String> event)
```

### 2. **äº‹ä»¶ç±»å‹è®¿é—®é”™è¯¯** âœ…
**åŸé—®é¢˜**: ä½¿ç”¨äº†ä¸å­˜åœ¨çš„æ–¹æ³•
```java
// âŒ é”™è¯¯çš„æ–¹æ³•è°ƒç”¨
switch (event.getType()) {

// âœ… æ­£ç¡®çš„æ–¹æ³•è°ƒç”¨
switch (event.getEventType()) {
```

### 3. **é”™è¯¯ä¿¡æ¯è·å–æ–¹å¼** âœ…
**åŸé—®é¢˜**: ä½¿ç”¨äº†é”™è¯¯çš„é”™è¯¯ä¿¡æ¯è·å–æ–¹æ³•
```java
// âŒ é”™è¯¯çš„æ–¹æ³•
event.getError()

// âœ… æ­£ç¡®çš„æ–¹æ³•
event.getErrorMessage()
```

### 4. **SessionManageræ–¹æ³•åé”™è¯¯** âœ…
**åŸé—®é¢˜**: è°ƒç”¨äº†ä¸å­˜åœ¨çš„æ–¹æ³•
```java
// âŒ ä¸å­˜åœ¨çš„æ–¹æ³•
sessionManager.hasActiveSession("monitor")
sessionManager.getOnlineUserCount("monitor")

// âœ… æ­£ç¡®çš„æ–¹æ³•
sessionManager.getOnlineCount("monitor") == 0
sessionManager.getOnlineCount("monitor")
```

### 5. **ç¼ºå°‘@Componentæ³¨è§£** âœ…
**åŸé—®é¢˜**: ç±»æ²¡æœ‰è¢«Springç®¡ç†
```java
// âŒ ç¼ºå°‘æ³¨è§£
@WebSocketService("monitor")
public class ThreadPoolMonitorWebSocketService

// âœ… æ·»åŠ Componentæ³¨è§£
@Component
@WebSocketService("monitor") 
public class ThreadPoolMonitorWebSocketService
```

## ğŸš€ ä¿®å¤åçš„å®Œæ•´åŠŸèƒ½

ç°åœ¨ `ThreadPoolMonitorWebSocketService` å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

### 1. **WebSocketè¿æ¥ç®¡ç†**
- âœ… å®¢æˆ·ç«¯è¿æ¥æ—¶å‘é€æ¬¢è¿æ¶ˆæ¯
- âœ… ç«‹å³æ¨é€å½“å‰ç›‘æ§æ•°æ®
- âœ… è¿æ¥æ–­å¼€æ—¶è®°å½•æ—¥å¿—
- âœ… é”™è¯¯å¤„ç†æœºåˆ¶

### 2. **å®æ—¶æ•°æ®æ¨é€**
- âœ… æ¯30ç§’è‡ªåŠ¨å¹¿æ’­ç›‘æ§æ•°æ®
- âœ… åªå‘æœ‰æ´»è·ƒè¿æ¥çš„å®¢æˆ·ç«¯æ¨é€
- âœ… åŒ…å«çº¿ç¨‹æ± æŒ‡æ ‡å’Œç›‘æ§çŠ¶æ€

### 3. **å¥åº·çŠ¶æ€è­¦æŠ¥**
- âœ… å¥åº·çŠ¶æ€å˜åŒ–æ—¶ç«‹å³æ¨é€è­¦æŠ¥
- âœ… ä¸åŒçº§åˆ«çš„è­¦æŠ¥åˆ†ç±»
- âœ… è¯¦ç»†çš„çŠ¶æ€å˜åŒ–æè¿°

### 4. **å‘½ä»¤å¤„ç†**
- âœ… æ”¯æŒåˆ·æ–°æ•°æ®å‘½ä»¤
- âœ… æ”¯æŒå¥åº·æ£€æŸ¥è¯·æ±‚
- âœ… æ”¯æŒè¯¦ç»†æŠ¥å‘Šè¯·æ±‚
- âœ… é”™è¯¯å‘½ä»¤å¤„ç†

### 5. **ç³»ç»Ÿç»Ÿè®¡æ¨é€**
- âœ… æ¯5åˆ†é’Ÿæ¨é€ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯
- âœ… JVMå†…å­˜ä½¿ç”¨æƒ…å†µ
- âœ… ç³»ç»Ÿè´Ÿè½½ä¿¡æ¯

## ğŸ” æ•´ä½“æ¶æ„æ£€æŸ¥

ä¿®å¤æ—¶æˆ‘æ£€æŸ¥äº†æ•´ä¸ªæ¡†æ¶çš„æ¶æ„ï¼š

1. **WebSocketMessageHandleræ¥å£**: ç¡®è®¤æ–¹æ³•ç­¾åå’Œè¿”å›å€¼
2. **WebSocketEventç±»**: ç¡®è®¤äº‹ä»¶ç±»å‹è®¿é—®æ–¹å¼å’Œå±æ€§å
3. **WebSocketSessionManager**: ç¡®è®¤å¯ç”¨çš„æ–¹æ³•å
4. **ç°æœ‰æœåŠ¡å®ç°**: å‚è€ƒChatRoomWebSocketServiceçš„æ­£ç¡®å®ç°
5. **Springæ³¨è§£**: ç¡®ä¿æ­£ç¡®çš„ä¾èµ–æ³¨å…¥

## ğŸ“Š éªŒè¯æ–¹æ³•

è¦éªŒè¯ä¿®å¤æ˜¯å¦æˆåŠŸï¼Œå¯ä»¥ï¼š

1. **å¯åŠ¨åº”ç”¨**:
   ```bash
   mvn spring-boot:run
   ```

2. **è®¿é—®ç›‘æ§ç•Œé¢**:
   ```
   http://localhost:8080/monitor
   ```

3. **æ£€æŸ¥WebSocketè¿æ¥**:
   - æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
   - æŸ¥çœ‹Networkæ ‡ç­¾ä¸‹çš„WebSocketè¿æ¥
   - åº”è¯¥çœ‹åˆ°è¿æ¥æˆåŠŸå’Œæ•°æ®æ¨é€

4. **æŸ¥çœ‹æ—¥å¿—**:
   ```bash
   tail -f logs/websocket-framework.log | grep -i monitor
   ```

## ğŸ¯ ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨

ä¿®å¤åçš„ä»£ç ç°åœ¨å®Œå…¨ç¬¦åˆæ¡†æ¶çš„è®¾è®¡æ¨¡å¼ï¼Œå¯ä»¥ï¼š

- âœ… æ­£å¸¸è¿æ¥WebSocket
- âœ… å®æ—¶æ¨é€ç›‘æ§æ•°æ®  
- âœ… å¤„ç†å®¢æˆ·ç«¯å‘½ä»¤
- âœ… å‘é€å¥åº·çŠ¶æ€è­¦æŠ¥
- âœ… å¹¿æ’­ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯

æ‰€æœ‰ç»„ä»¶éƒ½å·²ç»æ­£ç¡®é›†æˆï¼Œä½ ç°åœ¨å¯ä»¥å¯åŠ¨åº”ç”¨å¹¶è®¿é—®å¯è§†åŒ–ç›‘æ§ç•Œé¢äº†ï¼